use master
go

IF EXISTS (SELECT name FROM master.dbo.sysdatabases WHERE name = 'Prova02')
	DROP DATABASE Prova02

CREATE DATABASE Prova02
go

use Prova02
go
Set dateformat dmy
go
create table tblpais (
cd_pais int primary key,
nm_pais char(50))
go
create table tblequipe (
cd_eq int primary key, 
nm_eq char(50), 
cd_pais int, 
foreign key (cd_pais) references tblpais)

create table tblpiloto (
cd_pil int primary key, 
nm_pil char(50), cd_eq int, 
cd_pais int, 
foreign key (cd_eq) references tblequipe, 
foreign key (cd_pais) references tblpais)

create table tblcircuito (
cd_cir int primary key, 
nm_cir char(50), 
cd_pais int, 
foreign key (cd_pais) references tblpais)

create table tblprova (
cd_pro int primary key, 
tp_pro int not null, 
dt_pro date not null, 
cd_cir int, 
foreign key (cd_cir) references tblcircuito)

create table tblpiloto_pos (
cd_pil int, 
cd_pro int, 
posicao int not null, 
primary key (cd_pil, cd_pro), 
foreign key (cd_pil) references tblpiloto, 
foreign key (cd_pro) references tblprova)

--- INSERTS -----

insert into tblpais (cd_pais, nm_pais) values 
(1,'Afeganistão'),
(2,'África do Sul'),
(3,'Albânia'),
(4,'Alemanha'),
(5,'Andorra'), 
(6,'Angola'),
(7,'Anguilla'), 
(8,'Antártida'), 
(9,'Antígua e Barbuda'), 
(10,'Arábia Saudita'), 
(11,'Argélia'),
(12,'Argentina'),
(13,'Armênia'), 
(14,'Aruba'),
(15,'Austrália'), 
(16,'Áustria'),
(17,'Azerbaijão'),
(18,'Bahamas'),
(19,'Bahrein'), 
(20,'Bangladesh'),
(21,'Barbados'),
(22,'Belarus'), 
(23,'Bélgica'),
(24,'Belize'), 
(25,'Benin'),
(26,'Bermudas'),
(27,'Bolívia'), 
(28,'Bonaire, St. Eustatius & Saba'),
(29,'Bósnia-Herzegóvina'), 
(30,'Botsuana'),
(31,'Brasil'),
(32,'Brunei'), 
(33,'Bulgária'),
(34,'Burkina Faso'), 
(35,'Burundi'),
(36,'Butão'),
(37,'Cabo Verde'), 
(38,'Camarões'),
(39,'Camboja'),
(40,'Canadá'),
(41,'Cazaquistão'), 
(42,'Chade'),
(43,'Chile'),
(44,'China'),
(45,'Chipre'),
(46,'Cingapura'),
(47,'Colômbia'), 
(48,'Congo'),
(49,'Coréia do Norte'), 
(50,'Coréia do Sul'),
(51,'Costa do Marfim'), 
(52,'Costa Rica'), 
(53,'Croácia'),
(54,'Cuba'),
(55,'Curaçao'),
(56,'Dinamarca'), 
(57,'Djibuti'),
(58,'Dominica'), 
(59,'Egito'),
(60,'El Salvador'),
(61,'Emirados Árabes Unidos'),
(62,'Equador'),
(63,'Eritréia'),
(64,'Eslováquia'),
(65,'Eslovênia'), 
(66,'Espanha'),
(67,'Estados Unidos'), 
(68,'Estônia'),
(69,'Etiópia'),
(70,'Federação Russa'), 
(71,'Fiji'),
(72,'Filipinas'),
(73,'Finlândia'), 
(74,'França'),
(75,'Gabão'),
(76,'Gâmbia'), 
(77,'Gana'),
(78,'Geórgia'),
(79,'Gibraltar'),
(80,'Grã-Bretanha (Reino Unido)'),
(81,'Granada'),
(82,'Grécia'),
(83,'Groelândia'),
(84,'Guadalupe'),
(85,'Guam (Território dos Estados Unidos)'),
(86,'Guatemala'),
(87,'Guernsey'), 
(88,'Guiana'), 
(89,'Guiana Francesa'), 
(90,'Guiné'),
(91,'Guiné Equatorial'), 
(92,'Guiné-Bissau'),
(93,'Haiti'),
(94,'Holanda'),
(95,'Honduras'),
(96,'Hong Kong'), 
(97,'Hungria'), 
(98,'Iêmen'),
(99,'Ilha Bouvet (Território da Noruega)'), 
(100,'Ilha do Homem'), 
(101,'Ilha Natal'),
(102,'Ilha Pitcairn'),
(103,'Ilha Reunião'),
(104,'Ilhas Aland'),
(105,'Ilhas Cayman'),
(106,'Ilhas Cocos'),
(107,'Ilhas Comores'), 
(108,'Ilhas Cook'),
(109,'Ilhas Faroes'),
(110,'Ilhas Falkland (Malvinas)'),
(111,'Ilhas Geórgia do Sul e Sandwich do Sul'),
(112,'Ilhas Heard e McDonald (Território da Austrália)'), 
(113,'Ilhas Marianas do Norte'), 
(114,'Ilhas Marshall'),
(115,'Ilhas Menores dos Estados Unidos'), 
(116,'Ilhas Norfolk'),
(117,'Ilhas Seychelles'), 
(118,'Ilhas Salomão'),
(119,'Ilhas Svalbard e Jan Mayen'),
(120,'Ilhas Tokelau'),
(121,'Ilhas Turks & Caicos'),
(122,'Ilhas Virgens (Estados Unidos)'), 
(123,'Ilhas Virgens (Inglaterra)'), 
(124,'Ilhas Wallis & Futuna'), 
(125,'Índia'),
(126,'Indonésia'), 
(127,'Irã'),
(128,'Iraque'),
(129,'Irlanda'),
(130,'Islândia'), 
(131,'Israel'),
(132,'Itália'),
(133,'Jamaica'), 
(134,'Japão'),
(135,'Jersey'),
(136,'Jordânia'),
(137,'Kiribati'), 
(138,'Kuait'),
(139,'Laos'),
(140,'Látvia'),
(141,'Lesoto'),
(142,'Líbano'), 
(143,'Libéria'), 
(144,'Líbia'),
(145,'Liechtenstein'), 
(146,'Lituânia'),
(147,'Luxemburgo'), 
(148,'Macau'),
(149,'Macedônia (República Yugoslava)'), 
(150,'Madagascar'), 
(151,'Malásia'),
(152,'Malaui'),
(153,'Maldivas'), 
(154,'Mali'),
(155,'Malta'),
(156,'Marrocos'),
(157,'Martinica'),
(158,'Maurício'),
(159,'Mauritânia'), 
(160,'Mayotte'),
(161,'México'),
(162,'Micronésia'),
(163,'Moçambique'), 
(164,'Moldova'),
(165,'Mônaco'),
(166,'Mongólia'),
(167,'Montenegro'),
(168,'Montserrat'), 
(169,'Myanmar'),
(170,'Namíbia'), 
(171,'Nauru'),
(172,'Nepal'),
(173,'Nicarágua'), 
(174,'Níger'),
(175,'Nigéria'), 
(176,'Niue'),
(177,'Noruega'),
(178,'Nova Caledônia'),
(179,'Nova Zelândia'), 
(180,'Omã'),
(181,'Palau'),
(182,'Panamá'),
(183,'Papua-Nova Guiné'), 
(184,'Paquistão'),
(185,'Paraguai'), 
(186,'Peru'),
(187,'Polinésia Francesa'), 
(188,'Polônia'),
(189,'Porto Rico'), 
(190,'Portugal'), 
(191,'Qatar'),
(192,'Quênia'),
(193,'Quirguistão'),
(194,'República Centro-Africana'),
(195,'República Democrática do Congo'), 
(196,'República Dominicana'), 
(197,'República Tcheca'), 
(198,'Romênia'),
(199,'Ruanda'),
(200,'Saara Ocidental'),
(201,'Saint Vincent & Granadinas'), 
(202,'Samoa Ocidental'),
(203,'Samoa Ocidental'), 
(204,'San Marino'),
(205,'Santa Helena'),
(206,'Santa Lúcia'),
(207,'São Bartolomeu'),
(208,'São Cristóvão e Névis'), 
(209,'San Martin'),
(210,'São Tomé e Príncipe'),
(211,'Senegal'),
(212,'Serra Leoa'),
(213,'Sérvia'),
(214,'Síria'),
(215,'Somália'),
(216,'Sri Lanka'),
(217,'St. Maarten'),
(218,'St. Pierre & Miquelon'), 
(219,'Suazilândia'),
(220,'Sudão'),
(221,'Sudão do Sul'),
(222,'Suécia'),
(223,'Suíça'),
(224,'Suriname'),
(225,'Tadjiquistão'), 
(226,'Tailândia'), 
(227,'Taiwan'),
(228,'Tanzânia'),
(229,'Território Britânico do Oceano índico'), 
(230,'Territórios do Sul da França'),
(231,'Territórios Palestinos Ocupados'), 
(232,'Timor Leste'), 
(233,'Togo'),
(234,'Tonga'),
(235,'Trinidad & Tobago'),
(236,'Tunísia'),
(237,'Turcomenistão'), 
(238,'Turquia'),
(239,'Tuvalu'),
(240,'Ucrânia'),
(241,'Uganda'),
(242,'Uruguai'),
(243,'Uzbequistão'), 
(244,'Vanuatu'),
(245,'Vaticano'),
(246,'Venezuela'), 
(247,'Vietnã'),
(248,'Zâmbia'),
(249,'Zimbábue')



insert into tblequipe (cd_eq, nm_eq, cd_pais)
 values (01, 'Red Bull Racing', 80),
 (02, 'Mc Laren', 80),
 (03, 'Ferrari', 132),
 (04, 'Mercedes', 80),
 (05, 'Lotus', 80),
 (06, 'Force India', 80),
 (07, 'Sauber', 223),
 (08, 'Toro Rosso', 132),
 (09, 'Williams', 80),
 (10, 'Caterham', 80),
 (11, 'HRT', 66),
 (12, 'Marussia', 80)
go
insert into tblpiloto (cd_pil, nm_pil, cd_eq, cd_pais)
 values (01,'Sebastian Vettel', 01, 04),
 (02, 'Mark Webber', 01, 15),
 (03,'Jenson Button', 02, 123),
 (04,'Lewis Hamilton', 02, 123),
 (05,'Fernando Alonso', 03, 66),
 (06,'Felipe Massa', 03, 31),
 (07,'Michael Schumacher', 04, 04),
 (08,'Nico Rosberg', 04, 04),
 (09,'Kimi Räikkönen', 05, 73),
 (10,'Romain Grosjean', 05, 74),
 (11,'Paul di Resta', 06, 123),
 (12,'Nico Hulkenberg', 06, 04),
 (13,'Kamui kobayashi', 07, 134),
 (14,'Sergio Perez', 07, 161),
 (15,'Daniel Ricciardo', 11, 15),
 (16,'Jean-Eric Vergne', 08, 74),
 (17,'Pastor Maldonado', 09, 246),
 (18,'Bruno Senna', 10, 31),
 (19,'Heikki Kovalainen', 05, 73),
 (20,'Jarno Trulli', 05, 132),
 (21,'Pedro de la Rosa', 07, 66),
 (22,'Timo Glock', 12, 04),
 (23,'Charles Pic', 12, 74),
 (24, 'Vitaly Petrov', 10, 70),
 (25, 'Nick Heidfeld', 10, 04),
 (26, 'Adrian Sutil', 06, 04),
 (27, 'Jaime Alguersuario', 08, 04),
 (28, 'Sebastien Buemi', 08, 04),
 (29, 'Rubens Barrichello',09, 31),
 (30, 'Vitantonio Liuzzi', 11, 132),
 (31, 'Jerome d Ambrosio', 12, 23),
 (32, 'Narain Karthikeyan', 11, 125),
 (33, 'Karun Chandhok', 11, 125)
go
insert into tblcircuito (cd_cir, nm_cir, cd_pais)
values (01, 'Albert Park', 15),
(02, 'Circuito Internacional Sepang', 151),
(03, 'Circuito Internacional Shanghai', 44),
(04, 'Instanbul Park', 238),
(05, 'Circuito da Catalunya', 66),
(06, 'Circuito de Mônaco', 165),
(07, 'Circuito Gilles Villeneuve', 40),
(08, 'Circuito de rua de Valência', 66),
(09, 'Circuito Silverstone', 123),
(10, 'Nürburgring', 04),
(11, 'Hungaroring', 97),
(12, 'Circuito de Spa-Francorchamps', 23),
(13, 'Autódromo Nacional de Monza', 132),
(14, 'Circuito de rua Marina Bay', 46),
(15, 'Circuito Suzuka', 134),
(16, 'Circuito Internacional Coreano', 50),
(17, 'Circuito Internacional Buddh', 125),
(18, 'Circuito Internacional Yas Marina', 61),
(19, 'Autódromo José Carlos Pace', 31)
go  
insert into tblprova (cd_pro,tp_pro, dt_pro, cd_cir)
values (01, 89, '27/03/2011', 01),
(02, 97, '10/04/2011', 02),
(03, 96, '17/04/2011', 03),
(04, 90, '08/05/2011', 04),
(05, 99, '22/05/2011', 05),
(06, 69, '29/05/2011', 06),
(07, 244, '12/06/2011', 07),
(08, 99, '26/06/2011', 08),
(09, 88, '10/07/2011', 09),
(10, 97, '24/07/2011', 10),
(11, 106, '31/07/2011', 11),
(12, 86, '28/08/2011', 12),
(13, 80, '11/09/2011', 13),
(14, 119, '25/09/2011', 14),
(15, 90, '09/10/2011', 15),
(16, 98, '16/10/2011', 16),
(17, 90, '30/10/2011', 17),
(18, 97, '13/11/2011', 18),
(19, 92, '27/11/2011', 19);
go
insert into tblpiloto_pos (cd_pil,cd_pro, posicao)
values (01, 01, 01),
(04, 01, 02),
(24, 01, 03),
(05, 01, 04),
(02, 01, 05),
(03, 01, 06),
(06, 01, 07),
(28, 01, 08),
(26, 01, 09),
(11, 01, 10),
(27, 01, 11),
(25, 01, 12),
(20, 01, 13),
(31, 01, 14),


(01, 02, 01),
(03, 02, 02),
(25, 02, 03),
(02, 02, 04),
(06, 02, 05),
(05, 02, 06),
(13, 02, 07),
(04, 02, 08),
(07, 02, 09),
(11, 02, 10),
(26, 02, 11),
(08, 02, 12),
(28, 02, 13),
(27, 02, 14),
(19, 02, 15),
(22, 02, 16),
(24, 02, 17),



(04, 03, 01),
(01, 03, 02),
(02, 03, 03),
(03, 03, 04),
(12, 03, 05),
(06, 03, 06),
(05, 03, 07),
(07, 03, 08),
(24, 03, 09),
(13, 03, 10),
(11, 03, 11),
(25, 03, 12),
(29, 03, 13),
(28, 03, 14),
(26, 03, 15),
(19, 03, 16),
(14, 03, 17),
(17, 03, 18),
(20, 03, 19),
(31, 03, 20),
(22, 03, 21),
(30, 03, 22),
(32, 03, 23),



(01, 04, 01),
(02, 04, 02),
(05, 04, 03),
(04, 04, 04),
(08, 04, 05),
(03, 04, 06),
(25, 04, 07),
(24, 04, 08),
(28, 04, 09),
(13, 04, 10),
(06, 04, 11),
(07, 04, 12),
(26, 04, 13),
(14, 04, 14),
(29, 04, 15),
(27, 04, 16),
(17, 04, 17),
(20, 04, 18),
(19, 04, 19),
(31, 04, 20),
(32, 04, 21),
(30, 04, 22),


(01, 05, 01),
(04, 05, 02),
(03, 05, 03),
(02, 05, 04),
(05, 05, 05),
(07, 05, 06),
(08, 05, 07),
(25, 05, 08),
(14, 05, 09),
(13, 05, 10),
(24, 05, 11),
(11, 05, 12),
(26, 05, 13),
(28, 05, 14),
(17, 05, 15),
(27, 05, 16),
(29, 05, 17),
(20, 05, 18),
(22, 05, 19),
(31, 05, 20),
(32, 05, 21),


(01, 06, 01),
(05, 06, 02),
(03, 06, 03),
(02, 06, 04),
(13, 06, 05),
(04, 06, 06),
(26, 06, 07),
(25, 06, 08),
(29, 06, 09),
(28, 06, 10),
(08, 06, 11),
(11, 06, 12),
(20, 06, 13),
(19, 06, 14),
(31, 06, 15),
(30, 06, 16),
(32, 06, 17),
(17, 06, 18),

(03, 07, 01),
(01, 07, 02),
(02, 07, 03),
(07, 07, 04),
(24, 07, 05),
(06, 07, 06),
(13, 07, 07),
(27, 07, 08),
(29, 07, 09),
(28, 07, 10),
(08, 07, 11),
(21, 07, 12),
(30, 07, 13),
(31, 07, 14),
(22, 07, 15),
(20, 07, 16),
(32, 07, 17),
(11, 07, 18),


(01, 08, 01),
(05, 08, 02),
(02, 08, 03),
(04, 08, 04),
(06, 08, 05),
(03, 08, 06),
(08, 08, 07),
(27, 08, 08),
(26, 08, 09),
(25, 08, 10),
(14, 08, 11),
(29, 08, 12),
(28, 08, 13),
(11, 08, 14),
(24, 08, 15),
(13, 08, 16),
(07, 08, 17),
(17, 08, 18),
(19, 08, 19),
(20, 08, 20),
(22, 08, 21),
(31, 08, 22),
(30, 08, 23),
(32, 08, 24),


(05, 09, 01),
(01, 09, 02),
(02, 09, 03),
(04, 09, 04),
(06, 09, 05),
(08, 09, 06),
(14, 09, 07),
(25, 09, 08),
(07, 09, 09),
(27, 09, 10),
(26, 09, 11),
(24, 09, 12),
(29, 09, 13),
(17, 09, 14),
(11, 09, 15),
(22, 09, 16),
(31, 09, 17),
(30, 09, 18),
(15, 09, 19),


(04, 10, 01),
(05, 10, 02),
(02, 10, 03),
(01, 10, 04),
(06, 10, 05),
(26, 10, 06),
(08, 10, 07),
(07, 10, 08),
(13, 10, 09),
(24, 10, 10),
(14, 10, 11),
(27, 10, 12),
(11, 10, 13),
(17, 10, 14),
(28, 10, 15),
(19, 10, 16),
(22, 10, 17),
(31, 10, 18),
(15, 10, 19),
(33, 10, 20),


(03, 11, 01),
(01, 11, 02),
(05, 11, 03),
(04, 11, 04),
(02, 11, 05),
(06, 11, 06),
(11, 11, 07),
(28, 11, 08),
(08, 11, 09),
(27, 11, 10),
(13, 11, 11),
(24, 11, 12),
(29, 11, 13),
(26, 11, 14),
(14, 11, 15),
(17, 11, 16),
(22, 11, 17),
(15, 11, 18),
(31, 11, 19),
(30, 11, 20),


(01, 12, 01),
(02, 12, 02),
(03, 12, 03),
(05, 12, 04),
(07, 12, 05),
(08, 12, 06),
(26, 12, 07),
(06, 12, 08),
(24, 12, 09),
(17, 12, 10),
(11, 12, 11),
(13, 12, 12),
(18, 12, 13),
(20, 12, 14),
(19, 12, 15),
(29, 12, 16),
(31, 12, 17),
(22, 12, 18),
(30, 12, 19),


(01, 13, 01),
(03, 13, 02),
(05, 13, 03),
(04, 13, 04),
(07, 13, 05),
(06, 13, 06),
(27, 13, 07),
(11, 13, 08),
(18, 13, 09),
(28, 13, 10),
(17, 13, 11),
(29, 13, 12),
(19, 13, 13),
(20, 13, 14),
(22, 13, 15),


(01, 14, 01),
(03, 14, 02),
(02, 14, 03),
(05, 14, 04),
(04, 14, 05),
(11, 14, 06),
(08, 14, 07),
(26, 14, 08),
(06, 14, 09),
(14, 14, 10),
(17, 14, 11),
(28, 14, 12),
(29, 14, 13),
(13, 14, 14),
(18, 14, 15),
(19, 14, 16),
(24, 14, 17),
(31, 14, 18),
(15, 14, 19),
(30, 14, 20),
(27, 14, 21),

(03, 15, 01),
(05, 15, 02),
(01, 15, 03),
(02, 15, 04),
(04, 15, 05),
(07, 15, 06),
(06, 15, 07),
(14, 15, 08),
(24, 15, 09),
(08, 15, 10),
(26, 15, 11),
(11, 15, 12),
(13, 15, 13),
(17, 15, 14),
(27, 15, 15),
(18, 15, 16),
(29, 15, 17),
(19, 15, 18),
(20, 15, 19),
(22, 15, 20),
(31, 15, 21),
(15, 15, 22),
(30, 15, 23),

(01, 16, 01),
(04, 16, 02),
(02, 16, 03),
(03, 16, 04),
(05, 16, 05),
(06, 16, 06),
(27, 16, 07),
(08, 16, 08),
(28, 16, 09),
(11, 16, 10),
(26, 16, 11),
(29, 16, 12),
(18, 16, 13),
(19, 16, 14),
(13, 16, 15),
(14, 16, 16),
(20, 16, 17),
(22, 16, 18),
(15, 16, 19),
(31, 16, 20),
(30, 16, 21),


(01, 17, 01),
(03, 17, 02),
(05, 17, 03),
(02, 17, 04),
(07, 17, 05),
(08, 17, 06),
(04, 17, 07),
(27, 17, 08),
(26, 17, 09),
(14, 17, 10),
(24, 17, 11),
(18, 17, 12),
(11, 17, 13),
(19, 17, 14),
(29, 17, 15),
(31, 17, 16),
(32, 17, 17),
(15, 17, 18),
(20, 17, 19),

(04, 18, 01),
(05, 18, 02),
(03, 18, 03),
(02, 18, 04),
(06, 18, 05),
(08, 18, 06),
(07, 18, 07),
(26, 18, 08),
(11, 18, 09),
(13, 18, 10),
(14, 18, 11),
(29, 18, 12),
(24, 18, 13),
(17, 18, 14),
(27, 18, 15),
(18, 18, 16),
(19, 18, 17),
(20, 18, 18),
(22, 18, 19),
(30, 18, 20),


(02, 19, 01),
(01, 19, 02),
(03, 19, 03),
(05, 19, 04),
(06, 19, 05),
(26, 19, 06),
(08, 19, 07),
(11, 19, 08),
(13, 19, 09),
(24, 19, 10),
(27, 19, 11),
(28, 19, 12),
(14, 19, 13),
(29, 19, 14),
(07, 19, 15),
(19, 19, 16),
(18, 19, 17),
(20, 19, 18),
(31, 19, 19),
(15, 19, 20);

--1) Listar o nome de cada equipe seguida do nome do país que ela representa, mas listar também os demais países que não tem representação.
select p.nm_pais, e.nm_eq from tblequipe e
	right join tblpais p --right join pega tudo o que for comum (interseccao) E tudo o que for pertencente somente a tabela da direita (tblpais)
		on p.cd_pais = e.cd_pais

/*aqui, se inverter, aparece apenas quem tem representante:*/
select p.nm_pais, e.nm_eq from tblpais p
	right join tblequipe e
		on p.cd_pais = e.cd_pais

--2) Listar o nome de cada equipe seguida do nome do país que ela representa.
select e.nm_eq, p.nm_pais from tblpais p
	right join tblequipe e
		on p.cd_pais = e.cd_pais

--op.2
select tblequipe.nm_eq, tblpais.nm_pais from tblequipe, tblpais
	where tblequipe.cd_pais=tblpais.cd_pais

--3) Listar o nome dos pilotos que obtiveram 1º lugar em alguma prova (posiçao=1). Não é necessário repetir o nome do piloto caso ele tenha obtido o 1º lugar em mais de uma prova.
select nm_pil from tblpiloto 
	where tblpiloto.cd_pil in 
		(select distinct tblpiloto_pos.cd_pil from tblpiloto_pos where posicao='1')

--4) Listar o nome dos pilotos e a posição de cada um obtida no GP do Brasil. 
select (select tblpiloto.nm_pil from tblpiloto 
	where tblpiloto.cd_pil = tblpiloto_pos.cd_pil) as nm_pil, tblpiloto_pos.posicao from tblpiloto_pos
		where tblpiloto_pos.cd_pro = 19 order by tblpiloto_pos.posicao;

--5) Listar o nome da equipe, seguida do número de pilotos da equipe, somente quando o número de pilotos por equipe for maior do que 2.
select nm_eq, (select count(tblpiloto.cd_pil) from tblpiloto
	where tblequipe.cd_eq = tblpiloto.cd_eq) as qntdPilotos from tblequipe 
		where (select count(tblpiloto.cd_pil) from tblpiloto 
			where tblequipe.cd_eq = tblpiloto.cd_eq) > 2;
